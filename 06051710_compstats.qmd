---
title: "Computational Statistics Coursework 2025/2026"
subtitle: 'MSc in Statistics 2025/26, Imperial College London'
author: "06051710"
format:
  html:
    toc: true
    highlight: tango
    self-contained: true
    df-print: paged
  pdf: default
format-links: false
editor: 
  markdown: 
    wrap: 72
---

```{=html}
<style type="text/css">
h1{
  font-size: 24pt;
}
h2{
  font-size: 18pt;
}
body{
  font-size: 12pt;
}
</style>
```

```{r setup, include = FALSE, tidy=TRUE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
include_solutions <- TRUE
```

```{r setup2, include=FALSE, tidy=TRUE}
set.seed(17)
require(rmarkdown)
require(knitr)
require(kableExtra)
# Put any library imports and other preamble here.
```

I, 06051710, certify that this assessed coursework is my own work, unless otherwise acknowledged, and includes no plagiarism. I have not discussed my coursework with anyone else except when seeking clarification with the module lecturer via email or on MS Teams. I have not shared any code underlying my coursework with anyone else prior to submission.

# Question 1

**Part a.**\
I implemented the standard version of the Random Walk Metropolis Hastings algorithm. The first thing I did, mainly so that I could get a better idea of where to initialise my chain from, was plot the target distribution, @fig-1.

```{r}
#| echo: false
#| label: fig-1
#| fig-cap: "Target Distribution up to normalisation constant"

#######################
# Question 1
#######################

library(coda)

target <- function(x) {
  if (x>=2){
    return (exp(-3*(x-2)) + exp(-(x-30)^2) + exp(-((x-20)^2)/0.01))
  }
  else{
    return (0)
  }
}

t=seq(0,50, length.out=1000)
plot(t, sapply(t, function(t) target(t)), type="l", xlab="x", ylab = "f(x)")
```
The extremely sharp mode at x=20 stood out to me a lot for this distribution. As such, I decided to initialise the chains from multiple different starting points, to more easily view the mixing. These locations were x=2, 15, 20, 25, 30 and 35, as these were close to the 3 modes around x=2, 20, and 30. 

After this, I ran the algorithm with standard deviations of 1,2,3,5,8,and 11 in the proposal distribution and plotted the traceplots for each chain. As can be seen in @fig-2, for sigmas of 1-3 the chains did not 'mix well', with no chain sampling from all 3 modes. In @fig-3 it can be seen how some of the chains (specifically the ones initialised at x=2 and 15), manage to cover all three modes, however, it seems the distribution is best covered at higher standard deviations of around 8 and 11. To demonstrate how the standard deviation of 11 is better than that of 5, I created @fig-4 which shows the histogram of samples generated when a chain is initialised at x=25. As can be seen, the sigma of 5 completely misses the mode at x=2, whereas the higher standard deviations account for it.

```{r}
#| echo: false
#| label: fig-2
#| fig-cap: "Traceplots for smaller standard deviations"


MetrHastw <- function(X0, sigmaprop, nsteps, f){
  X <- numeric(nsteps+1) 
  X[1] <- X0
  for (i in 2:(nsteps+1)){
    Y <- rnorm(1, mean=X[i-1],sd=sigmaprop)
    if (log(runif(1)) <= log(f(Y)) -log(f(X[i-1]))){
      X[i] <- Y}
    else{ X[i] <- X[i-1]}
   }
 X
} 

#seems larger variance is better when we have 10,000 samples for mixing. All chains converge pretty fast, it's just the different modes that make this distribution difficult.

#I should also compute the Gelman Rubin statistic for each chain as a quantitative way to display convergence or lack thereof
#Also group all the plots in one figure

X0s <- c(2, 15, 20, 25, 30, 35)
chains1 <-lapply(X0s, function(x0) mcmc(MetrHastw(x0, sigmaprop=1, nsteps=10000, f=target)))
chains2 <-lapply(X0s, function(x0) mcmc(MetrHastw(x0, sigmaprop=2, nsteps=10000, f=target)))
chains3 <-lapply(X0s, function(x0) mcmc(MetrHastw(x0, sigmaprop=3, nsteps=10000, f=target)))
chains4 <-lapply(X0s, function(x0) mcmc(MetrHastw(x0, sigmaprop=5, nsteps=10000, f=target)))#actually ends up completely missing the mass around x=20
chains5 <-lapply(X0s, function(x0) mcmc(MetrHastw(x0, sigmaprop=8, nsteps=10000, f=target)))
chains6 <- lapply(X0s, function(x0) mcmc(MetrHastw(x0, sigmaprop=11, nsteps=10000, f=target)))

par(mfrow=c(1,3))  

traceplot(chains1); title("sigma = 1")
traceplot(chains2); title("sigma = 2")
traceplot(chains3); title("sigma = 3")
```

```{r}
#| echo: false
#| label: fig-3
#| fig-cap: "Traceplots for larger standard deviations"

par(mfrow=c(1,3))

traceplot(chains4); title("sigma = 5")
traceplot(chains5); title("sigma = 8")
traceplot(chains6); title("sigma = 11")
```
```{r}
#| echo: false
#| label: fig-4
#| fig-cap: "Histograms for different chains initialised at x=25"

par(mfrow=c(1,3))

hist(chains4[[4]], breaks=100, freq=F, xlab='x', main='Sigma=5')
hist(chains5[[4]], breaks=100, freq=F, xlab='x', main='Sigma=8')
hist(chains6[[4]], breaks=100, freq=F, xlab='x', main='Sigma=11')


```



